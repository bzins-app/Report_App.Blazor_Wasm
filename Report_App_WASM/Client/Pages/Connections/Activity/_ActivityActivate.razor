@inject ISnackbar Snackbar


<MudSwitch Style="justify-content: center" Value="@Item!.IsEnabled" Color="Color.Primary" ThumbIcon="@(Item.IsEnabled ? Icons.Material.Filled.Done : Icons.Material.Filled.Close)" ThumbIconColor="@(Item.IsEnabled ? Color.Success : Color.Error)" ValueChanged="(bool value) => ChangeStatusAsync(value)"/>

@code {

    [Parameter] public DataProviderDto? Item { get; set; }

    private async Task ChangeStatusAsync(bool value)
    {
        Item!.IsEnabled = value;
        var result = await DataService.PostValues(new ApiBackgroundWorkerPayload { Activate = Item.IsEnabled, Value = Item.DataProviderId }, "ActivatePerActivity", "api/BackgroundWorker/");
        if (!result.Success)
        {
            Item.IsEnabled = !value;
            Snackbar.Add(Localizer.Get("An error has occurred"), Severity.Error);
            if (result.Message != null) Snackbar.Add(result.Message, Severity.Error);
            return;
        }

        await DataService.PostValues(Item, "ActivityUpdate");

        Snackbar.Add(Item.IsEnabled ? Item.ProviderName + " " + Localizer.Get("enabled") : Item.ProviderName + " " + Localizer.Get("disabled"), Item.IsEnabled ? Severity.Success : Severity.Normal);
    }

}