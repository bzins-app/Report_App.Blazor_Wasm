@page "/"
@page "/Home"
@attribute [Authorize]
@inject HttpClient Http

<PageTitle>@localizer.Get("Welcome")</PageTitle>

<div class="text-center">
    <h1 class="display-4">@localizer.Get("Welcome")</h1>
    @*<p>Learn about <a href="https://docs.microsoft.com/aspnet/core">building Web apps with ASP.NET Core</a>.</p>*@
</div>
<MudCard>
    <MudCardContent>
        @if (activities.Any())
        {
            foreach (var t in activities)
            {
                <AuthorizeView Roles=@t.ActivityName>
                    <div>
                        <hr style="margin-bottom:15px" />
                        <h5>@localizer.Get("You have access to the activity"): @t.ActivityName</h5>
                        <p>@localizer.Get("You can download the reports already created and consult the plan of the next report executions.")</p>
                        <div class="row">
                            <div class="col">
                                <a class="nav-link" href="/RetrieveReports/@t.ActivityName/@t.ActivityId"><span class="pcoded-micon"><i class="fa fa-arrow-right"></i></span><span class="pcoded-mtext"> @localizer.Get("Retrieve reports")</span></a>
                            </div>
                            @if (context.User.IsInRole("Supervisor"))
                            {
                                <div class="col">
                                    <a class="nav-link" href="/TasksPerActivity/Report/@t.ActivityName"><span class="pcoded-micon"><i class="fa fa-arrow-right"></i></span><span class="pcoded-mtext"> @localizer.Get("Manage reports")</span></a>
                                </div>
                            }
                        </div>
                    </div>
                </AuthorizeView>
            }
        }

@*        <AuthorizeView Roles="toDefine">
            <div>
                <hr style="margin-bottom:15px" />
                <p>@localizer.Get("Unfortunately, you do not yet have any access")</p>
                <p>@localizer.Get("Ask an administrator to grant you rights")</p>
            </div>
        </AuthorizeView>*@

        <AuthorizeView Roles="Supervisor">
            <div>
                <hr style="margin-bottom:15px" />
                <h5>@localizer.Get("You have the role"): Supervisor</h5>
                <p>@localizer.Get("You can create, edit and delete reports.")</p>
            </div>
        </AuthorizeView>

        <AuthorizeView Roles="Admin">
            <div>
                <hr style="margin-bottom:15px" />
                <h5>@localizer.Get("You have the role"): Administrator</h5>
                <p>@localizer.Get("You have full access to the general settings.")</p>
            </div>
        </AuthorizeView>
    </MudCardContent>
</MudCard>

@code {

    private List<SelectItemActivitiesInfo> activities = new();

    protected override async Task OnInitializedAsync()
    {
        activities = await dataService.GetValues<SelectItemActivitiesInfo>("ActivitiesInfo", ApiControllers.ApplicationParametersApi);
    }
}